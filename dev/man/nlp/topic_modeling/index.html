<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Topic Modeling · QuranTree.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="QuranTree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="QuranTree.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">QuranTree.jl</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../indexing/">Indexing</a></li><li><a class="tocitem" href="../../transliteration/">Transliteration</a></li><li><a class="tocitem" href="../../morphological_features/">Morphological Features</a></li><li><a class="tocitem" href="../../data_processing/">Data Processing</a></li><li><span class="tocitem">Natural Language Processing</span><ul><li><a class="tocitem" href="../nlp/">Introduction</a></li><li><a class="tocitem" href="../text_summarization/">Text Summarization</a></li><li class="is-active"><a class="tocitem" href>Topic Modeling</a></li></ul></li><li><span class="tocitem">CAMeL Tools</span><ul><li><a class="tocitem" href="../../camel/external/">Content</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Natural Language Processing</a></li><li class="is-active"><a href>Topic Modeling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Topic Modeling</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/alstat/QuranTree.jl/blob/master/docs/src/man/nlp/topic_modeling.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Topic-Modeling"><a class="docs-heading-anchor" href="#Topic-Modeling">Topic Modeling</a><a id="Topic-Modeling-1"></a><a class="docs-heading-anchor-permalink" href="#Topic-Modeling" title="Permalink"></a></h1><p>Another application of Natural Language Processing is Topic Modeling, and in this section, we are going to extract the topics for Chapter 18 (The Cave). To do this, again <a href="https://juliahub.com/docs/TextAnalysis/5Mwet/0.7.2/">TextAnalysis.jl</a> (Julia&#39;s leading NLP library) is used. The model for this task will be Latent Dirichlet Allocation (LDA), but Latent Semantic Analysis (LSA) is also available in <a href="https://juliahub.com/docs/TextAnalysis/5Mwet/0.7.2/">TextAnalysis.jl</a>. To start with, load the data as follows:</p><pre><code class="language-julia-repl">julia&gt; using JuliaDB

julia&gt; using PrettyTables

julia&gt; using QuranTree

julia&gt; using TextAnalysis

julia&gt; @ptconf vcrop_mode=:middle tf=tf_compact

julia&gt; crps, tnzl = QuranData() |&gt; load;

julia&gt; crpsdata = table(crps)
Quranic Arabic Corpus (morphology)
(C) 2011 Kais Dukes

Table with 128219 rows, 7 columns:
Columns:
#  colname   type
───────────────────
1  chapter   Int64
2  verse     Int64
3  word      Int64
4  part      Int64
5  form      String
6  tag       String
7  features  String</code></pre><p>!!! info &#39;Note&#39;     You need to install <a href="https://github.com/JuliaData/JuliaDB.jl">JuliaDB.jl</a> and <a href="https://github.com/ronisbr/PrettyTables.jl">PrettyTables.jl</a> to successfully run the code. </p><pre><code class="language-julia">    using Pkg
    Pkg.add(&quot;JuliaDB&quot;)
    Pkg.add(&quot;PrettyTables&quot;)
    ```

## Data Preprocessing
The first data processing will be the removal of all Disconnected Letters like الٓمٓ ,الٓمٓصٓ, among others. This is done as follows:</code></pre><p>@repl abc function preprocess(s::String)     feat = parse(Features, s)     disletters = isfeature(feat, AbstractDisLetters)     prepositions = isfeature(feat, AbstractPreposition)     particles = isfeature(feat, AbstractParticle)     conjunctions = isfeature(feat, AbstractConjunction)     pronouns = isfeature(feat, AbstractPronoun)     adverbs = isfeature(feat, AbstractAdverb)</p><pre><code class="language-none">return !disletters &amp;&amp; !prepositions &amp;&amp; !particles &amp;&amp; !conjunctions &amp;&amp; !pronouns &amp;&amp; !adverbs</code></pre><p>end</p><p>crpstbl = filter(t -&gt; preprocess(t.features), crpsdata[18].data)</p><pre><code class="language-none">Next, we create a copy of the above data so we have the original state, and use the copy to do further data processing.</code></pre><p>@repl abc crpsnew = deepcopy(crpstbl) feats = select(crpsnew, :features) feats = parse.(Features, feats)</p><pre><code class="language-none">## Lemmatization
Using the above parsed features, we then convert the `form` of the tokens into its lemma. This is useful for addressing minimal variations due to inflection.</code></pre><p>@repl abc lemmas = lemma.(feats) forms1 = select(crpsnew, :form) forms1[.!ismissing.(lemmas)] = lemmas[.!ismissing.(lemmas)]</p><pre><code class="language-none">!!! tip &quot;Tips&quot;
    We can also use the `Root` features instead, which is done by simply replacing `lemma.(feats)` with `root.(feats)`. 

We now put back the new form to the corpus:</code></pre><p>@repl abc crpsnew = transform(crpsnew, :form =&gt; forms1) crpsnew = CorpusData(crpsnew)</p><pre><code class="language-none">## Tokenization
We want to summarize the Qur&#39;an at the verse level. Thus, the token would be the verses of the corpus. From these verses, we further clean it by dediacritization and normalization of the characters:</code></pre><p>@repl abc lem<em>vrs = verses(crpsnew) vrs = QuranTree.normalize.(dediac.(lem</em>vrs))</p><pre><code class="language-none">## Creating a TextAnalysis Corpus
To make use of the [TextAnalysis.jl&#39;s APIs](https://juliahub.com/docs/TextAnalysis/5Mwet/0.7.2/APIReference/), we need to encode the processed Quranic Corpus to [TextAnalysis.jl](https://juliahub.com/docs/TextAnalysis/5Mwet/0.7.2/)&#39;s Corpus. In this case, we will create a `StringDocument` of the verses.</code></pre><p>@repl abc crps1 = Corpus(StringDocument.(vrs))</p><pre><code class="language-none">We then update the lexicon and inverse index for efficient indexing of the corpus.</code></pre><p>@repl abc update<em>lexicon!(crps1) update</em>inverse_index!(crps1)</p><pre><code class="language-none">Next, we create a Document Term Matrix, which will have rows of verses and columns of words describing the verses.</code></pre><p>@repl abc m1 = DocumentTermMatrix(crps1)</p><pre><code class="language-none">## Latent Dirichlet Allocation
Finally, run LDA as follows:</code></pre><p>@repl abc k = 3          # number of topics iter = 1000    # number of gibbs sampling iterations alpha = 0.1    # hyperparameter beta = 0.1     # hyperparameter ϕ, θ = lda(m1, k, iter, alpha, beta)</p><pre><code class="language-none">Extract the topic for first cluster:</code></pre><p>@repl abc ntopics = 10 cluster<em>topics = Matrix(undef, ntopics, k); for i = 1:k     topics</em>idcs = sortperm(ϕ[i, :], rev=true)     cluster<em>topics[:, i] = arabic.(m1.terms[topics</em>idcs][1:ntopics]) end @pt cluster_topics</p><pre><code class="language-none">Extract the topic for each verse</code></pre><p>@repl abc vrs<em>topics = [] for i = 1:dtm(m1).m     push!(vrs</em>topics, sortperm(θ[:, i], rev=true)[1]) end @pt vrs_topics</p><pre><code class="language-none">Tabulating this propery would give us the following</code></pre><p>@example abc Pkg.add(&quot;DataFrames&quot;) Pkg.add(&quot;Latexify&quot;) using DataFrames: DataFrame using Latexify</p><p>mdtable(convert(DataFrame, cluster_topics), latex=false) ``` As you may have noticed, the result is not good and this is mainly due to data processing. Readers are encourage to improve this for their own use. This section, however, demonstrated how <a href="https://juliahub.com/docs/TextAnalysis/5Mwet/0.7.2/">TextAnalysis.jl</a>&#39;s LDA can be used for Topic Modeling the QuranTree.jl&#39;s corpus.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../text_summarization/">« Text Summarization</a><a class="docs-footer-nextpage" href="../../camel/external/">Content »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 23 January 2021 00:27">Saturday 23 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
